<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERP Afirma</title>
    <!-- Google font similar to site -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Estilos consolidados para el sistema de pestaÃ±as */
        .tab-container {
            margin: 20px 0;
        }
        .tab-buttons {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }
        .tab-button {
            padding: 12px 24px !important;
            background: none !important;
            border: none !important;
            cursor: pointer !important;
            font-size: 14px !important;
            font-weight: 500 !important;
            color: #666 !important;
            border-bottom: 2px solid transparent !important;
            transition: all 0.3s ease !important;
            border-radius: 0 !important;
            letter-spacing: normal !important;
            text-transform: none !important;
            pointer-events: auto !important;
            position: relative !important;
            z-index: 10 !important;
        }
        .tab-button:hover {
            color: #007bff !important;
            background-color: #f8f9fa !important;
        }
        .tab-button.active {
            color: #007bff !important;
            border-bottom-color: #007bff !important;
            background: none !important;
            font-weight: 600 !important;
        }
        .tab-content {
            display: none !important;
        }
        .tab-content.active {
            display: block !important;
        }
        
        /* Asegurar que el modal no estÃ© bloqueado */
        .modal {
            z-index: 1000 !important;
            pointer-events: auto !important;
        }
        .modal-content {
            z-index: 1001 !important;
            pointer-events: auto !important;
            position: relative !important;
        }
        .tab-container {
            pointer-events: auto !important;
            position: relative !important;
            z-index: 1002 !important;
        }
        
        /* Estilos para listas de contratos */
        .contracts-list {
            margin-top: 20px;
        }
        .contract-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 10px;
        }
        .contract-active {
            border-color: #007bff;
            background-color: #f8f9fa;
        }
    </style>
    
    <!-- SweetAlert2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <!-- Authentication Guard -->
    <script src="js/auth.js"></script>
    <script>
        // Require authentication to access this page
        if (!requireAuth()) {
            // Will redirect to login if not authenticated
        }
    </script>

    <!-- topbar + shell to match a modern ERP look -->
    <header class="topbar">
        <div class="topbar-inner">
            <div class="topbar-left">
                <img src="assets/logo.png" alt="logo" class="topbar-logo">
                <div class="topbar-title">ERP AFIRMA</div>
            </div>
            <div class="topbar-right" id="user-info">
                <div class="user-pill">Cargando...</div>
            </div>
        </div>
    </header>

    <div class="app-shell">
        <aside class="sidebar">
            <div class="brand">
                <img src="assets/logo.png" alt="Afirma logo" class="brand-image">
                <div>
                    <div class="brand-title">ERP AFIRMA</div>
                    <div style="font-size:12px;color:rgba(255,255,255,0.7)">Sistema de gestiÃ³n</div>
                </div>
            </div>

            <nav class="nav">
                <a href="#" data-view="home" class="active">Inicio</a>
                <a href="#" data-view="alta">Empleados</a>
                <a href="#" data-view="reclutamiento">Reclutamiento</a>
                <a href="#" data-view="inventario-equipos">Inventario de Equipos</a>
                <a href="#" data-view="vacaciones">Vacaciones</a>
                <a href="#" data-view="proyectos">Proyectos</a>
                <a href="#" data-view="ordenes-trabajo">Ã“rdenes de Trabajo</a>
                <a href="#" data-view="importar-ots">Importar OTs</a>
                <a href="#" data-view="asignaciones">Asignaciones</a>
                <a href="#" data-view="reportes">Reportes</a>
                <a href="#" data-view="catalogos">CatÃ¡logos</a>
            </nav>

            <div style="margin-top:auto;font-size:12px;color:rgba(255,255,255,0.6)">Afirma Solutions</div>
        </aside>

        <main class="content">
                        <!-- Vista para importar OTs desde Excel -->
                        <section id="importar-ots" class="card view" style="display:none;max-width:700px;margin:0 auto;">
                            <h2>Importar OTs desde Excel</h2>
                            <div style="margin-bottom:16px;">
                                <button type="button" id="ot-template-btn" class="btn-add">ğŸ“¥ Descargar plantilla ejemplo</button>
                            </div>
                            <div style="margin-bottom:16px;">
                                <input type="file" id="ot-import-file-standalone" accept=".xlsx,.xls,.csv">
                            </div>
                            <div id="ot-import-preview-area" style="display:none;">
                                <h3>PrevisualizaciÃ³n y ediciÃ³n</h3>
                                <table id="ot-import-preview-table" style="width:100%;border-collapse:collapse;">
                                    <thead>
                                        <tr>
                                            <th>NÃºmero OT</th>
                                            <th>Folio Principal Santec</th>
                                            <th>Folio Santec</th>
                                            <th>Nombre Proyecto</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                            <div style="margin-top:16px;display:flex;gap:8px;">
                                <button type="button" id="ot-import-save-btn" class="btn-add" style="display:none;">Guardar OTs</button>
                                <button type="button" id="ot-import-cancel-btn" class="btn-cancel" style="display:none;">Cancelar</button>
                            </div>
                        </section>

            <!-- Vista de Ã“rdenes de Trabajo -->
            <section id="ordenes-trabajo" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">Ã“rdenes de Trabajo (OTs)</h2>
                    <button type="button" onclick="document.querySelector('[data-view=importar-ots]').click()" class="btn-add">ğŸ“¥ Importar OTs</button>
                </div>
                
                <!-- Filtros -->
                <div class="filters-container">
                    <input type="text" id="filter-ot-code" placeholder="ğŸ” Buscar por NÃºmero OT..." class="filter-input">
                    <select id="filter-ot-project" class="filter-input">
                        <option value="">ğŸ“ Todos los proyectos</option>
                    </select>
                    <select id="filter-ot-status" class="filter-input">
                        <option value="">ğŸ“Š Todos los estados</option>
                        <option value="Pendiente">Pendiente</option>
                        <option value="En Progreso">En Progreso</option>
                        <option value="Completada">Completada</option>
                    </select>
                    <button type="button" id="filter-ot-search-btn" class="filter-search-btn">ğŸ” Buscar</button>
                    <button type="button" id="filter-ot-clear-btn" class="filter-clear-btn">ğŸ”„ Limpiar</button>
                </div>
                
                <!-- Grid de OTs -->
                <div class="employee-grid-container">
                    <div id="ot-grid-loading" style="text-align:center;padding:40px;color:#666">
                        <div>Cargando Ã³rdenes de trabajo...</div>
                    </div>
                    <div class="employee-grid-wrapper" style="overflow-x:auto;">
                        <table class="employee-table" id="ot-table" style="display:none;">
                            <thead>
                                <tr>
                                    <th style="min-width:130px">ğŸ”¢ NÃºmero OT</th>
                                    <th style="min-width:120px">ğŸ“‹ Folio Principal</th>
                                    <th style="min-width:120px">ğŸ“„ Folio Santec</th>
                                    <th style="min-width:180px">ğŸ“ Proyecto</th>
                                    <th style="min-width:100px">ğŸ“Š Estado</th>
                                    <th style="min-width:200px">ğŸ“ DescripciÃ³n</th>
                                    <th style="min-width:120px">ğŸ› ï¸ Tipo Servicio</th>
                                    <th style="min-width:120px">ğŸ’» TecnologÃ­a</th>
                                    <th style="min-width:120px">ğŸ“± Aplicativo</th>
                                    <th style="min-width:120px">ğŸ“… Inicio Proveedor</th>
                                    <th style="min-width:120px">ğŸ“… Fin Proveedor</th>
                                    <th style="min-width:150px">ğŸ‘¤ LÃ­der Delivery</th>
                                    <th style="min-width:150px">ğŸ‘” Responsable</th>
                                    <th style="min-width:150px">ğŸ¢ CBT Responsable</th>
                                    <th style="min-width:130px">ğŸ’° Monto Servicio</th>
                                    <th style="min-width:130px">ğŸ’µ Monto con IVA</th>
                                    <th style="min-width:100px">â±ï¸ Horas</th>
                                    <th style="min-width:100px">ğŸ“ˆ % EjecuciÃ³n</th>
                                    <th style="min-width:150px">âš™ï¸ Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="ot-table-body">
                                <!-- Se llenarÃ¡ dinÃ¡micamente -->
                            </tbody>
                        </table>
                    </div>
                    <div id="ot-grid-empty" style="display:none;text-align:center;padding:40px;color:#999">
                        <div style="font-size:48px;margin-bottom:10px">ğŸ“‹</div>
                        <div style="font-size:18px;margin-bottom:5px">No hay Ã³rdenes de trabajo registradas</div>
                        <div style="font-size:14px">Haz clic en "Importar OTs" para comenzar</div>
                    </div>
                    <div id="ot-grid-error" style="display:none;text-align:center;padding:40px;color:#dc3545">
                        <div style="font-size:48px;margin-bottom:10px">âš ï¸</div>
                        <div style="font-size:18px;margin-bottom:5px">Error al cargar Ã³rdenes de trabajo</div>
                        <div style="font-size:14px" id="ot-error-message">Problema de conexiÃ³n con la API</div>
                        <button type="button" onclick="window.loadOrdersOfWork()" style="margin-top:15px;background:#007bff;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer">ğŸ”„ Reintentar</button>
                    </div>
                </div>
            </section>

            <div id="health-status" style="display:flex;gap:12px;align-items:center;background:#f8fafc;border:1px solid #e6eef8;border-radius:8px;padding:8px 12px;margin-bottom:12px;color:#374151">
                <div><strong>Frontend:</strong> <span id="health-frontend">verificando...</span></div>
                <div><strong>API:</strong> <span id="health-api">verificando...</span></div>
            </div>

            <section id="home" class="card view">
                <div style="text-align:center;padding:40px 20px;">
                    <h1 style="color:var(--brand-primary);font-size:2.5em;margin-bottom:10px;">ERP AFIRMA</h1>
                    <p style="font-size:1.2em;color:var(--muted);margin-bottom:40px;">Sistema de GestiÃ³n Empresarial</p>
                    
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;max-width:800px;margin:0 auto;">
                        <div class="home-card" onclick="document.querySelector('[data-view=alta]').click()">
                            <div style="font-size:3em;margin-bottom:10px;">ğŸ‘¥</div>
                            <h3>Empleados</h3>
                            <p>Gestiona la informaciÃ³n de empleados, contratos y recursos humanos</p>
                        </div>
                        
                        <div class="home-card" onclick="document.querySelector('[data-view=reclutamiento]').click()">
                            <div style="font-size:3em;margin-bottom:10px;">ğŸ¯</div>
                            <h3>Reclutamiento</h3>
                            <p>Administra candidatos y procesos de selecciÃ³n de personal</p>
                        </div>
                        
                        <div class="home-card" onclick="document.querySelector('[data-view=inventario-equipos]').click()">
                            <div style="font-size:3em;margin-bottom:10px;">ğŸ“¦</div>
                            <h3>Inventario de Equipos</h3>
                            <p>Control de activos, asignaciÃ³n de equipos y seguimiento</p>
                        </div>
                        
                        <div class="home-card" onclick="document.querySelector('[data-view=catalogos]').click()">
                            <div style="font-size:3em;margin-bottom:10px;">ğŸ“‹</div>
                            <h3>CatÃ¡logos</h3>
                            <p>ConfiguraciÃ³n de entidades, puestos, Ã¡reas y proyectos</p>
                        </div>
                    </div>
                    
                    <div style="margin-top:50px;padding-top:30px;border-top:1px solid var(--border);">
                        <p style="color:var(--muted);font-size:0.9em;">
                            ğŸ”§ Sistema en desarrollo - VersiÃ³n 1.0 <br>
                            ğŸ’¡ Utiliza el menÃº lateral para navegar entre mÃ³dulos
                        </p>
                    </div>
                </div>
            </section>

            <section id="alta" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">Empleados</h2>
                    <div style="display:flex;gap:8px">
                        <button type="button" id="import-employees-btn" class="btn-add">ğŸ“„ Importar Excel</button>
                        <button type="button" id="add-employee-btn" class="btn-add">+ Agregar Empleado</button>
                    </div>
                </div>
                
                <!-- File upload area (hidden by default) -->
                <div id="import-employees-area" style="display:none;background:#f0f4ff;border:2px dashed #0066ff;border-radius:8px;padding:20px;text-align:center;margin-bottom:20px">
                    <input type="file" id="excel-file-input" accept=".xlsx,.xls,.csv" style="display:none">
                    <div style="color:#0066ff;cursor:pointer;font-weight:600" id="import-click-area">
                        Haz clic para seleccionar un archivo Excel o arrastralo aquÃ­
                    </div>
                    <div style="font-size:12px;color:#6b7280;margin-top:8px">Soporta: .xlsx, .xls, .csv</div>
                    <div style="font-size:12px;color:#6b7280;margin-top:12px">Las columnas deben ser: CLIENTE / CÃ©lula / Fecha de ingreso / Fecha de asignaciÃ³n / Nombre del empleado / SGMM / vida / PosiciÃ³n / Proyecto / Tarifa inicial de contrataciÃ³n / Ãrea / TelÃ©fono laboral / TelÃ©fono personal / CPA / CPE / Correo con cliente / Correo de trabajo / Correo electrÃ³nico personal</div>
                    <div style="font-size:12px;color:#6b7280;margin-top:8px">Nota: el import acepta columnas adicionales y las guarda como metadatos del empleado (employee_documents).</div>
                    <button type="button" id="cancel-import-btn" style="margin-top:12px;background:#6b7280;padding:8px 12px;font-size:12px">Cancelar</button>
                </div>
                
                <!-- Filtros -->
                <div class="filters-container">
                    <input type="text" id="filter-name" placeholder="ğŸ” Buscar por nombre..." class="filter-input">
                    <input type="text" id="filter-position" placeholder="ğŸ’¼ Puesto / Rol..." class="filter-input">
                    <input type="text" id="filter-entity" placeholder="ğŸ¢ Entidad..." class="filter-input">
                    <select id="filter-status" class="filter-input">
                        <option value="">ğŸ“Š Todos los estados</option>
                        <option value="Activo">Activo</option>
                        <option value="Inactivo">Inactivo</option>
                        <option value="En licencia">En licencia</option>
                        <option value="Suspendido">Suspendido</option>
                    </select>
                    <button type="button" id="filter-search-btn" class="filter-search-btn">ğŸ” Buscar</button>
                    <button type="button" id="filter-clear-btn" class="filter-clear-btn">ğŸ”„ Limpiar</button>
                </div>
                
                <!-- Grid de empleados -->
                <div class="employee-grid-container">
                    <div id="employee-grid-loading" style="text-align:center;padding:40px;color:#666">
                        <div>Cargando empleados...</div>
                    </div>
                    <div class="employee-grid-wrapper" style="overflow-x:auto;">
                        <table id="employeeTable" style="display:none;">
                            <thead>
                                <tr>
                                    <th style="min-width:80px">ğŸ†” ID</th>
                                    <th style="min-width:200px">ğŸ‘¤ Nombre Completo</th>
                                    <th style="min-width:150px">ğŸ¢ Entidad</th>
                                    <th style="min-width:180px">ğŸ’¼ Puesto</th>
                                    <th style="min-width:130px">ğŸ“ Ãrea</th>
                                    <th style="min-width:150px">ğŸ¯ Proyecto</th>
                                    <th style="min-width:120px">ğŸ”§ CÃ©lula</th>
                                    <th style="min-width:100px">ğŸ“Š Estado</th>
                                    <th style="min-width:150px">âš™ï¸ Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="employee-table-body">
                                <!-- Se llenarÃ¡ dinÃ¡micamente -->
                            </tbody>
                        </table>
                    </div>
                    <div id="employee-grid-empty" style="display:none;text-align:center;padding:40px;color:#999">
                        <div style="font-size:48px;margin-bottom:10px">ğŸ‘¥</div>
                        <div style="font-size:18px;margin-bottom:5px">No hay empleados registrados</div>
                        <div style="font-size:14px">Haz clic en "Agregar Empleado" para comenzar</div>
                    </div>
                    <div id="employee-grid-error" style="display:none;text-align:center;padding:40px;color:#dc3545">
                        <div style="font-size:48px;margin-bottom:10px">âš ï¸</div>
                        <div style="font-size:18px;margin-bottom:5px">Error al cargar empleados</div>
                        <div style="font-size:14px" id="error-message">Problema de conexiÃ³n con la API</div>
                        <button type="button" onclick="window.reloadEmployees()" style="margin-top:15px;background:#007bff;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer">ğŸ”„ Reintentar</button>
                    </div>
                </div>
            </section>

            <section id="reclutamiento" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">Reclutamiento</h2>
                    <div style="display:flex;gap:8px">
                        <button type="button" id="import-candidates-btn" class="btn-add">ğŸ“„ Importar Excel</button>
                        <button type="button" id="add-candidate-btn" class="btn-add">+ Agregar Candidato</button>
                    </div>
                </div>
                
                <!-- File upload area (hidden by default) -->
                <div id="import-candidates-area" style="display:none;background:#f0f4ff;border:2px dashed #0066ff;border-radius:8px;padding:20px;text-align:center;margin-bottom:20px">
                    <input type="file" id="excel-file-candidates-input" accept=".xlsx,.xls,.csv" style="display:none">
                    <div style="color:#0066ff;cursor:pointer;font-weight:600" id="import-candidates-click-area">
                        Haz clic para seleccionar un archivo Excel o arrastralo aquÃ­
                    </div>
                    <div style="font-size:12px;color:#6b7280;margin-top:8px">Soporta: .xlsx, .xls, .csv</div>
                    <div style="font-size:12px;color:#6b7280;margin-top:12px">Las columnas deben ser: Nombre, Apellido, Email, TelÃ©fono, PosiciÃ³n, Estado, Notas</div>
                    <button type="button" id="cancel-import-candidates-btn" style="margin-top:12px;background:#6b7280;padding:8px 12px;font-size:12px">Cancelar</button>
                </div>
                
                <ul id="candidate-list" class="candidate-list"></ul>
            </section>

            <section id="inventario-equipos" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">Inventario de Equipos</h2>
                    <div style="display:flex;gap:8px">
                        <button type="button" id="load-inventory-excel-btn" class="btn-add" onclick="loadInventoryFromExcel()">ğŸ—„ï¸ Cargar Inventario</button>
                        <button type="button" id="add-equipment-btn" class="btn-add" onclick="openEquipmentModal(null)">+ Agregar Equipo</button>
                    </div>
                </div>
                
                <!-- Filtros de Inventario -->
                <div class="filters-container">
                    <input type="text" id="filter-equipment-code" placeholder="ğŸ” Buscar por cÃ³digo..." class="filter-input">
                    <input type="text" id="filter-equipment-name" placeholder="ğŸ“¦ Nombre del equipo..." class="filter-input">
                    <select id="filter-equipment-category" class="filter-input">
                        <option value="">ğŸ·ï¸ Todas las categorÃ­as</option>
                        <option value="Computo">CÃ³mputo</option>
                        <option value="Mobiliario">Mobiliario</option>
                        <option value="Electronico">ElectrÃ³nico</option>
                        <option value="Herramientas">Herramientas</option>
                        <option value="Vehiculos">VehÃ­culos</option>
                    </select>
                    <select id="filter-equipment-assigned" class="filter-input">
                        <option value="">ğŸ‘¤ Todos los asignados</option>
                        <option value="sin-asignar">Sin asignar</option>
                        <!-- Se llenarÃ¡ dinÃ¡micamente con empleados -->
                    </select>
                    <select id="filter-equipment-status" class="filter-input">
                        <option value="">ğŸ“Š Todos los estados</option>
                        <option value="Activo">Activo</option>
                        <option value="Inactivo">Inactivo</option>
                        <option value="Mantenimiento">En Mantenimiento</option>
                        <option value="Baja">Dado de Baja</option>
                    </select>
                    <button type="button" id="filter-equipment-search-btn" class="filter-search-btn" onclick="applyEquipmentFilters()">ğŸ” Buscar</button>
                    <button type="button" id="filter-equipment-clear-btn" class="filter-clear-btn" onclick="clearEquipmentFilters()">ğŸ”„ Limpiar</button>
                </div>
                
                <!-- Grid de Inventario -->
                <div class="equipment-grid-container">
                    <div id="equipment-grid-loading" style="text-align:center;padding:40px;color:#666">
                        <div>Cargando inventario de equipos...</div>
                    </div>
                    <div class="equipment-grid-wrapper" style="overflow-x:auto;">
                        <table class="equipment-table" id="equipment-table" style="display:none;">
                            <thead>
                                <tr>
                                    <th style="min-width:120px">ğŸ·ï¸ CÃ³digo</th>
                                    <th style="min-width:200px">ğŸ“¦ Equipo</th>
                                    <th style="min-width:120px">ğŸ­ Marca</th>
                                    <th style="min-width:120px">ğŸ“± Modelo</th>
                                    <th style="min-width:120px">ğŸ“‹ Serie</th>
                                    <th style="min-width:120px">ğŸ·ï¸ CategorÃ­a</th>
                                    <th style="min-width:120px">ğŸ“ UbicaciÃ³n</th>
                                    <th style="min-width:120px">ğŸ‘¤ Asignado</th>
                                    <th style="min-width:100px">ğŸ“Š Estado</th>
                                    <th style="min-width:120px">ğŸ’° Valor</th>
                                    <th style="min-width:120px">ğŸ“… Fecha Compra</th>
                                    <th style="min-width:150px">âš™ï¸ Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="equipment-table-body">
                                <!-- Se llenarÃ¡ dinÃ¡micamente -->
                            </tbody>
                        </table>
                    </div>
                    <div id="equipment-grid-empty" style="display:none;text-align:center;padding:40px;color:#999">
                        <div style="font-size:48px;margin-bottom:10px">ğŸ“¦</div>
                        <div style="font-size:18px;margin-bottom:5px">No hay equipos registrados</div>
                        <div style="font-size:14px">Haz clic en "Cargar Inventario" o "Agregar Equipo" para comenzar</div>
                    </div>
                    <div id="equipment-grid-error" style="display:none;text-align:center;padding:40px;color:#dc3545">
                        <div style="font-size:48px;margin-bottom:10px">âš ï¸</div>
                        <div style="font-size:18px;margin-bottom:5px">Error al cargar inventario</div>
                        <div style="font-size:14px" id="equipment-error-message">Problema al cargar el archivo Excel</div>
                        <button type="button" onclick="window.reloadEquipment()" style="margin-top:15px;background:#007bff;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer">ğŸ”„ Reintentar</button>
                    </div>
                </div>
            </section>

            <!-- Nueva secciÃ³n: Vacaciones -->
            <section id="vacaciones" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">Vacaciones de Empleados</h2>
                    <button type="button" id="add-vacation-btn" class="btn-add">+ Nueva Solicitud</button>
                </div>
                <div class="filters-container">
                    <select id="filter-vacation-employee" class="filter-input">
                        <option value="">ğŸ‘¤ Todos los empleados</option>
                    </select>
                    <select id="filter-vacation-status" class="filter-input">
                        <option value="">ğŸ“Š Todos los estados</option>
                        <option value="Pendiente">Pendiente</option>
                        <option value="Aprobado">Aprobado</option>
                        <option value="Rechazado">Rechazado</option>
                    </select>
                    <select id="filter-vacation-year" class="filter-input">
                        <option value="">ğŸ“† Todos los aÃ±os</option>
                    </select>
                    <select id="filter-vacation-month" class="filter-input">
                        <option value="">ğŸ“… Todos los meses</option>
                        <option value="01">Enero</option>
                        <option value="02">Febrero</option>
                        <option value="03">Marzo</option>
                        <option value="04">Abril</option>
                        <option value="05">Mayo</option>
                        <option value="06">Junio</option>
                        <option value="07">Julio</option>
                        <option value="08">Agosto</option>
                        <option value="09">Septiembre</option>
                        <option value="10">Octubre</option>
                        <option value="11">Noviembre</option>
                        <option value="12">Diciembre</option>
                    </select>
                    <button type="button" id="filter-vacation-search-btn" class="filter-search-btn">ğŸ” Buscar</button>
                    <button type="button" id="filter-vacation-clear-btn" class="filter-clear-btn">ğŸ”„ Limpiar</button>
                </div>
                <div class="employee-grid-container">
                    <div id="vacation-grid-loading" style="text-align:center;padding:40px;color:#666;display:none">
                        <div>Cargando solicitudes de vacaciones...</div>
                    </div>
                    <div id="vacation-grid-empty" style="display:none;text-align:center;padding:40px;color:#999">
                        <div style="font-size:48px;margin-bottom:10px">ğŸŒ´</div>
                        <div style="font-size:18px;margin-bottom:5px">No hay solicitudes registradas</div>
                        <div style="font-size:14px">Haz clic en "Nueva Solicitud" para comenzar</div>
                    </div>
                    <table class="employee-table" id="vacation-table" style="display:none;">
                        <thead>
                            <tr>
                                <th>ğŸ†” ID</th>
                                <th>ğŸ‘¤ Empleado</th>
                                <th>ğŸ“… Fecha Inicio</th>
                                <th>ğŸ“… Fecha Fin</th>
                                <th>ğŸ“Š Estado</th>
                                <th>âš™ï¸ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="vacation-table-body">
                            <!-- Se llenarÃ¡ dinÃ¡micamente -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Nueva secciÃ³n: Proyectos -->
            <section id="proyectos" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">GestiÃ³n de Proyectos</h2>
                    <div style="display:flex;align-items:center;gap:12px">
                        <button type="button" id="add-project-btn" class="btn-add">+ Nuevo Proyecto</button>
                    </div>
                </div>
                <div class="filters-container">
                    <select id="filter-project-status" class="filter-input">
                        <option value="">ğŸ“Š Todos los estados</option>
                        <option value="PlanificaciÃ³n">PlanificaciÃ³n</option>
                        <option value="En Progreso">En Progreso</option>
                        <option value="Completado">Completado</option>
                        <option value="En Espera">En Espera</option>
                    </select>
                    <button type="button" id="filter-project-search-btn" class="filter-search-btn">ğŸ” Buscar</button>
                    <button type="button" id="filter-project-clear-btn" class="filter-clear-btn">ğŸ”„ Limpiar</button>
                </div>
                <div class="employee-grid-container">
                    <div id="project-grid-loading" style="text-align:center;padding:40px;color:#666;display:none">
                        <div>Cargando proyectos...</div>
                    </div>
                    <div id="project-grid-empty" style="display:none;text-align:center;padding:40px;color:#999">
                        <div style="font-size:48px;margin-bottom:10px">ğŸ“‹</div>
                        <div style="font-size:18px;margin-bottom:5px">No hay proyectos registrados</div>
                        <div style="font-size:14px">Haz clic en "Nuevo Proyecto" para comenzar</div>
                    </div>
                    <table class="employee-table" id="project-table" style="display:none;">
                        <thead>
                            <tr>
                                <th>ğŸ†” ID</th>
                                <th>ğŸ“‹ Nombre</th>
                                <th>ğŸ“ DescripciÃ³n</th>
                                <th>ğŸ“… Fecha Inicio</th>
                                <th>ğŸ“… Fecha Fin</th>
                                <th>ğŸ“Š Estado</th>
                                <th>âš™ï¸ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="project-table-body">
                            <!-- Se llenarÃ¡ dinÃ¡micamente -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Modal para proyectos -->
            <div id="project-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width:900px">
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e5e7eb;">
                        <h2 id="project-modal-title" style="margin:0">Nuevo Proyecto</h2>
                        <button type="button" id="project-modal-close" style="background:none;border:none;font-size:24px;cursor:pointer;">âœ•</button>
                    </div>
                    
                    <!-- PestaÃ±as -->
                    <div class="tab-container">
                        <div class="tab-buttons">
                            <button type="button" class="tab-button active" data-tab="project-general">Datos Generales</button>
                            <button type="button" class="tab-button" data-tab="project-assignments">Asignaciones</button>
                        </div>
                    
                    <form id="project-form" style="padding:24px;">
                        <!-- PestaÃ±a: Datos Generales -->
                        <div class="tab-content active" id="tab-project-general">
                        <input type="hidden" id="project-id">
                        
                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">Nombre del Proyecto *</label>
                            <input type="text" id="project-name" required style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                        </div>

                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">DescripciÃ³n</label>
                            <textarea id="project-description" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff;resize:vertical;height:100px;"></textarea>
                        </div>

                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
                            <div>
                                <label style="display:block;margin-bottom:8px;font-weight:500;">Fecha Inicio *</label>
                                <input type="date" id="project-start-date" required style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                            </div>
                            <div>
                                <label style="display:block;margin-bottom:8px;font-weight:500;">Fecha Fin (Estimada)</label>
                                <input type="date" id="project-end-date" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                                <small style="display:block;margin-top:4px;color:#6b7280">Opcional - Dejar vacÃ­o si no tiene fecha definida</small>
                            </div>
                        </div>

                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">Estado *</label>
                            <select id="project-status" required style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                                <option value="PlanificaciÃ³n">PlanificaciÃ³n</option>
                                <option value="En Progreso">En Progreso</option>
                                <option value="Completado">Completado</option>
                                <option value="En Espera">En Espera</option>
                            </select>
                        </div>

                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">Responsable del Proyecto</label>
                            <select id="project-manager" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                                <option value="">Seleccionar responsable...</option>
                            </select>
                        </div>

                        <!-- Ã“rdenes de Trabajo (OTs) -->
                        <div style="margin-bottom:28px;">
                            <label style="display:block;margin-bottom:8px;font-weight:600;font-size:1.1em;">Ã“rdenes de Trabajo (OTs)</label>
                            <form id="ot-form" style="display:flex;gap:10px;align-items:flex-end;margin-bottom:12px;flex-wrap:wrap">
                                <input type="text" id="ot-code" placeholder="CÃ³digo OT *" required style="flex:1;min-width:120px;padding:8px;border:1px solid #e6eef8;border-radius:6px;">
                                <input type="text" id="ot-description" placeholder="DescripciÃ³n" style="flex:2;min-width:180px;padding:8px;border:1px solid #e6eef8;border-radius:6px;">
                                <select id="ot-status" style="flex:1;min-width:120px;padding:8px;border:1px solid #e6eef8;border-radius:6px;">
                                    <option value="Pendiente">Pendiente</option>
                                    <option value="En Progreso">En Progreso</option>
                                    <option value="Completada">Completada</option>
                                </select>
                                <input type="date" id="ot-start-date" style="flex:1;min-width:120px;padding:8px;border:1px solid #e6eef8;border-radius:6px;">
                                <input type="date" id="ot-end-date" style="flex:1;min-width:120px;padding:8px;border:1px solid #e6eef8;border-radius:6px;">
                                <button type="button" id="ot-add-btn" class="btn-primary" style="padding:8px 16px;font-size:14px">+ Agregar OT</button>
                            </form>
                            <div id="ot-list-container" style="background:#f8fafc;border-radius:8px;padding:10px 0;max-height:180px;overflow-y:auto;border:1px solid #e6eef8;">
                                <table style="width:100%;font-size:14px;">
                                    <thead>
                                        <tr style="background:#f1f5f9">
                                            <th style="padding:6px 8px;">CÃ³digo</th>
                                            <th style="padding:6px 8px;">DescripciÃ³n</th>
                                            <th style="padding:6px 8px;">Estado</th>
                                            <th style="padding:6px 8px;">Inicio</th>
                                            <th style="padding:6px 8px;">Fin</th>
                                            <th style="padding:6px 8px;">AcciÃ³n</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ot-list-body">
                                        <!-- OTs se llenan dinÃ¡micamente -->
                                    </tbody>
                                </table>
                                <div id="ot-list-empty" style="text-align:center;color:#999;padding:12px;display:none">No hay OTs registradas</div>
                            </div>
                        </div>

                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                            <button type="button" id="project-cancel" class="btn-secondary">Cancelar</button>
                            <button type="submit" id="project-submit" class="btn-primary">Guardar Proyecto</button>
                        </div>
                        </div>
                        
                        <!-- PestaÃ±a: Asignaciones -->
                        <div class="tab-content" id="tab-project-assignments">
                            <div style="padding:24px">
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                                    <h4 style="margin:0">Recursos Asignados</h4>
                                    <button type="button" id="project-add-assignment" class="btn-primary" style="padding:8px 16px;font-size:14px">+ Asignar Recurso</button>
                                </div>
                                
                                <div id="project-assignments-loading" style="text-align:center;padding:20px;color:#666;display:none">
                                    Cargando asignaciones...
                                </div>
                                <div id="project-assignments-empty" style="text-align:center;padding:20px;color:#999;display:none">
                                    <div style="font-size:32px;margin-bottom:10px">ğŸ‘¥</div>
                                    <div>No hay recursos asignados a este proyecto</div>
                                    <button type="button" onclick="document.getElementById('project-add-assignment').click()" style="margin-top:12px;background:#007bff;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer">Asignar Primer Recurso</button>
                                </div>
                                <table class="employee-table" id="project-assignments-table" style="display:none;width:100%">
                                    <thead>
                                        <tr>
                                            <th>ğŸ‘¤ Empleado</th>
                                            <th>ğŸ’¼ Puesto</th>
                                            <th>ğŸ¯ Rol</th>
                                            <th>ğŸ“… Inicio</th>
                                            <th>ğŸ“… Fin</th>
                                            <th>â° Horas</th>
                                            <th>ğŸ“Š Estado</th>
                                            <th>âš™ï¸ Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="project-assignments-tbody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </form>
                    </div>
                </div>
            </div>

            <!-- Nueva secciÃ³n: Asignaciones de Recursos a Proyectos -->
            <section id="asignaciones" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">Asignaciones de Recursos</h2>
                    <button type="button" id="add-assignment-btn" class="btn-add">+ Nueva AsignaciÃ³n</button>
                </div>
                
                <!-- Filtros -->
                <div class="filters-container">
                    <select id="filter-assignment-employee" class="filter-input" style="width:250px">
                        <option value="">ğŸ‘¤ Todos los empleados</option>
                    </select>
                    <select id="filter-assignment-project" class="filter-input" style="width:250px">
                        <option value="">ğŸ“‹ Todos los proyectos</option>
                    </select>
                    <select id="filter-assignment-status" class="filter-input">
                        <option value="">ğŸ“Š Todos los estados</option>
                        <option value="active">Asignaciones Activas</option>
                        <option value="completed">Finalizadas</option>
                    </select>
                    <button type="button" id="filter-assignment-search-btn" class="filter-search-btn">ğŸ” Buscar</button>
                    <button type="button" id="filter-assignment-clear-btn" class="filter-clear-btn">ğŸ”„ Limpiar</button>
                </div>

                <!-- Indicador de recursos en banca -->
                <div id="bench-indicator" style="background:#fff3cd;border:1px solid #ffc107;border-radius:8px;padding:12px 16px;margin-bottom:20px;display:none;">
                    <div style="display:flex;align-items:center;gap:10px">
                        <span style="font-size:24px">âš ï¸</span>
                        <div>
                            <strong style="color:#856404">Recursos disponibles en Banca:</strong>
                            <span id="bench-count" style="margin-left:8px;background:#ffc107;color:#000;padding:2px 8px;border-radius:4px;font-weight:bold">0</span>
                            <button type="button" id="view-bench-details" style="margin-left:12px;background:#ffc107;color:#000;border:none;padding:4px 12px;border-radius:4px;cursor:pointer;font-weight:500">Ver Detalles</button>
                        </div>
                    </div>
                </div>
                
                <div class="employee-grid-container">
                    <div id="assignment-grid-loading" style="text-align:center;padding:40px;color:#666;display:none">
                        <div>Cargando asignaciones...</div>
                    </div>
                    <div id="assignment-grid-empty" style="display:none;text-align:center;padding:40px;color:#999">
                        <div style="font-size:48px;margin-bottom:10px">ğŸ“Š</div>
                        <div style="font-size:18px;margin-bottom:5px">No hay asignaciones registradas</div>
                        <div style="font-size:14px">Haz clic en "Nueva AsignaciÃ³n" para comenzar</div>
                    </div>
                    <table class="employee-table" id="assignment-table" style="display:none;">
                        <thead>
                            <tr>
                                <th>ğŸ†” ID</th>
                                <th>ğŸ‘¤ Empleado</th>
                                <th>ğŸ’¼ Puesto</th>
                                <th>ğŸ“‹ Proyecto</th>
                                <th>ğŸ¯ Rol en Proyecto</th>
                                <th>ğŸ“… Fecha Inicio</th>
                                <th>ğŸ“… Fecha Fin</th>
                                <th>â° Horas Asignadas</th>
                                <th>ğŸ“Š Estado</th>
                                <th>âš™ï¸ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="assignment-table-body">
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Modal para crear/editar asignaciÃ³n -->
            <div id="assignment-modal" class="modal" style="display:none;">
                <div class="modal-content">
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e5e7eb;">
                        <h2 id="assignment-modal-title" style="margin:0">Nueva AsignaciÃ³n</h2>
                        <button type="button" id="assignment-modal-close" style="background:none;border:none;font-size:24px;cursor:pointer;">âœ•</button>
                    </div>
                    <form id="assignment-form" style="padding:24px;">
                        <input type="hidden" id="assignment-id">
                        
                        <div id="assignment-conflict-alert" style="display:none;background:#fee;border:1px solid #fcc;border-radius:8px;padding:12px;margin-bottom:20px;color:#c33">
                            <div style="display:flex;align-items:center;gap:8px">
                                <span style="font-size:20px">âš ï¸</span>
                                <div>
                                    <strong>Conflicto de AsignaciÃ³n</strong>
                                    <div id="assignment-conflict-message" style="font-size:14px;margin-top:4px"></div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">Proyecto *</label>
                            <select id="assignment-project" required style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                                <option value="">Seleccionar proyecto...</option>
                            </select>
                        </div>

                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">Empleado (Recurso) *</label>
                            <select id="assignment-employee" required style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                                <option value="">Seleccionar empleado...</option>
                            </select>
                            <small style="display:block;margin-top:4px;color:#6b7280">Solo se muestran empleados sin asignaciones activas</small>
                        </div>

                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">Rol en el Proyecto</label>
                            <input type="text" id="assignment-role" placeholder="Ej: Desarrollador, LÃ­der TÃ©cnico, Analista..." style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                        </div>

                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
                            <div>
                                <label style="display:block;margin-bottom:8px;font-weight:500;">Fecha Inicio *</label>
                                <input type="date" id="assignment-start-date" required style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                            </div>
                            <div>
                                <label style="display:block;margin-bottom:8px;font-weight:500;">Fecha Fin (Estimada)</label>
                                <input type="date" id="assignment-end-date" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                                <small style="display:block;margin-top:4px;color:#6b7280">Dejar vacÃ­o si no tiene fecha definida</small>
                            </div>
                        </div>

                        <div style="margin-bottom:20px;">
                            <label style="display:block;margin-bottom:8px;font-weight:500;">Horas Asignadas (por semana)</label>
                            <input type="number" id="assignment-hours" min="1" max="60" step="0.5" placeholder="Ej: 40" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                            <small style="display:block;margin-top:4px;color:#6b7280">Horas semanales dedicadas al proyecto</small>
                        </div>

                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                            <button type="button" id="assignment-cancel" class="btn-secondary">Cancelar</button>
                            <button type="submit" id="assignment-submit" class="btn-primary">Guardar AsignaciÃ³n</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal para ver recursos en banca -->
            <div id="bench-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width:900px">
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e5e7eb;">
                        <h2 style="margin:0">ğŸ–ï¸ Recursos Disponibles (Banca)</h2>
                        <button type="button" id="bench-modal-close" style="background:none;border:none;font-size:24px;cursor:pointer;">âœ•</button>
                    </div>
                    <div style="padding:24px;">
                        <p style="color:#6b7280;margin-bottom:20px">Empleados activos sin asignaciones activas a proyectos</p>
                        
                        <div id="bench-grid-loading" style="text-align:center;padding:40px;color:#666;display:none">
                            <div>Cargando recursos...</div>
                        </div>
                        
                        <div id="bench-grid-empty" style="display:none;text-align:center;padding:40px;color:#28a745">
                            <div style="font-size:48px;margin-bottom:10px">âœ…</div>
                            <div style="font-size:18px;margin-bottom:5px">Â¡Excelente!</div>
                            <div style="font-size:14px">Todos los recursos estÃ¡n asignados a proyectos activos</div>
                        </div>
                        
                        <table class="employee-table" id="bench-table" style="display:none;">
                            <thead>
                                <tr>
                                    <th>ğŸ‘¤ Empleado</th>
                                    <th>ğŸ’¼ Puesto</th>
                                    <th>ğŸ¢ Ãrea</th>
                                    <th>ğŸ­ Entidad</th>
                                    <th>ğŸ“… Ãšltimo Proyecto</th>
                                    <th>â° DÃ­as sin Proyecto</th>
                                    <th>âš™ï¸ AcciÃ³n</th>
                                </tr>
                            </thead>
                            <tbody id="bench-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Nueva secciÃ³n: Reportes -->
            <section id="reportes" class="card view" style="display:none;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
                    <h2 style="margin:0">ğŸ“Š Reportes y AnÃ¡lisis</h2>
                    <div style="display:flex;gap:8px">
                        <button type="button" id="refresh-reports-btn" class="btn-add" style="background:#6c757d">ğŸ”„ Actualizar</button>
                        <button type="button" id="export-reports-btn" class="btn-add" style="background:#28a745">ğŸ“¥ Exportar</button>
                    </div>
                </div>

                <!-- Resumen General -->
                <div id="reports-summary" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:30px">
                    <div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:20px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                        <div style="font-size:32px;font-weight:bold" id="summary-active-employees">-</div>
                        <div style="font-size:14px;opacity:0.9">Empleados Activos</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;padding:20px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                        <div style="font-size:32px;font-weight:bold" id="summary-active-projects">-</div>
                        <div style="font-size:14px;opacity:0.9">Proyectos Activos</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);color:white;padding:20px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                        <div style="font-size:32px;font-weight:bold" id="summary-assigned-employees">-</div>
                        <div style="font-size:14px;opacity:0.9">Empleados Asignados</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%);color:white;padding:20px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                        <div style="font-size:32px;font-weight:bold" id="summary-bench-employees">-</div>
                        <div style="font-size:14px;opacity:0.9">Recursos en Banca</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#fa709a 0%,#fee140 100%);color:white;padding:20px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                        <div style="font-size:32px;font-weight:bold" id="summary-projects-with-assignments">-</div>
                        <div style="font-size:14px;opacity:0.9">Proyectos con Recursos</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#30cfd0 0%,#330867 100%);color:white;padding:20px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                        <div style="font-size:32px;font-weight:bold" id="summary-total-hours">-</div>
                        <div style="font-size:14px;opacity:0.9">Horas Totales Activas</div>
                    </div>
                </div>

                <!-- Tabs de Reportes -->
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button type="button" class="tab-button active" onclick="switchReportTab('resources-by-project', event)">Recursos por Proyecto</button>
                        <button type="button" class="tab-button" onclick="switchReportTab('projects-by-resource', event)">Proyectos por Recurso</button>
                        <button type="button" class="tab-button" onclick="switchReportTab('top-projects', event)">Top Proyectos</button>
                        <button type="button" class="tab-button" onclick="switchReportTab('top-resources', event)">Top Recursos</button>
                    </div>

                    <!-- Tab: Recursos por Proyecto -->
                    <div class="tab-content active" id="report-tab-resources-by-project" style="margin-top:20px">
                        <div id="resources-by-project-loading" style="text-align:center;padding:40px;color:#666;display:none">
                            Cargando reporte...
                        </div>
                        <div id="resources-by-project-container"></div>
                    </div>

                    <!-- Tab: Proyectos por Recurso -->
                    <div class="tab-content" id="report-tab-projects-by-resource" style="margin-top:20px">
                        <div id="projects-by-resource-loading" style="text-align:center;padding:40px;color:#666;display:none">
                            Cargando reporte...
                        </div>
                        <div id="projects-by-resource-container"></div>
                    </div>

                    <!-- Tab: Top Proyectos -->
                    <div class="tab-content" id="report-tab-top-projects" style="margin-top:20px">
                        <div id="top-projects-container" style="background:white;padding:24px;border-radius:8px;border:1px solid #e5e7eb">
                            <h3 style="margin-top:0">ğŸ† Proyectos con MÃ¡s Recursos Asignados</h3>
                            <table class="employee-table" id="top-projects-table">
                                <thead>
                                    <tr>
                                        <th>ğŸ… PosiciÃ³n</th>
                                        <th>ğŸ“‹ Proyecto</th>
                                        <th>ğŸ‘¥ # Recursos</th>
                                    </tr>
                                </thead>
                                <tbody id="top-projects-tbody"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab: Top Recursos -->
                    <div class="tab-content" id="report-tab-top-resources" style="margin-top:20px">
                        <div id="top-resources-container" style="background:white;padding:24px;border-radius:8px;border:1px solid #e5e7eb">
                            <h3 style="margin-top:0">â­ Recursos MÃ¡s Activos</h3>
                            <table class="employee-table" id="top-resources-table">
                                <thead>
                                    <tr>
                                        <th>ğŸ… PosiciÃ³n</th>
                                        <th>ğŸ‘¤ Empleado</th>
                                        <th>ğŸ“‹ # Proyectos</th>
                                        <th>â° Horas Totales</th>
                                    </tr>
                                </thead>
                                <tbody id="top-resources-tbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section id="catalogos" class="card view" style="display:none;">
                <h2 style="margin-top:0">ğŸ“‹ GestiÃ³n de CatÃ¡logos</h2>
                <p style="color:#555;margin-top:4px">Administra las listas maestras del sistema. Cada catÃ¡logo controla las opciones disponibles en formularios y reportes.</p>
                
                <!-- Grid de botones de catÃ¡logos -->
                <div class="catalog-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 24px;">
                    
                    <!-- Entidades -->
                    <div class="catalog-card" style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; background: #fff; cursor: pointer; transition: all 0.2s;" onclick="openCatalogManager('Entidad')">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #3b82f6, #1d4ed8); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                <span style="color: white; font-size: 18px;">ğŸ¢</span>
                            </div>
                            <h3 style="margin: 0; color: #1f2937; font-size: 16px;">Entidades</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin: 0; line-height: 1.4;">Administra las entidades u organizaciones del sistema</p>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #f3f4f6;">
                            <span style="color: #3b82f6; font-size: 12px; font-weight: 500;">Click para gestionar â†’</span>
                        </div>
                    </div>
                    
                    <!-- Puestos/Roles -->
                    <div class="catalog-card" style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; background: #fff; cursor: pointer; transition: all 0.2s;" onclick="openCatalogManager('Puestos roles')">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                <span style="color: white; font-size: 18px;">ğŸ‘”</span>
                            </div>
                            <h3 style="margin: 0; color: #1f2937; font-size: 16px;">Puestos / Roles</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin: 0; line-height: 1.4;">Gestiona los puestos de trabajo y roles organizacionales</p>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #f3f4f6;">
                            <span style="color: #10b981; font-size: 12px; font-weight: 500;">Click para gestionar â†’</span>
                        </div>
                    </div>
                    
                    <!-- Ãreas -->
                    <div class="catalog-card" style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; background: #fff; cursor: pointer; transition: all 0.2s;" onclick="openCatalogManager('Areas')">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                <span style="color: white; font-size: 18px;">ğŸ—ï¸</span>
                            </div>
                            <h3 style="margin: 0; color: #1f2937; font-size: 16px;">Ãreas de Trabajo</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin: 0; line-height: 1.4;">Define las Ã¡reas operativas y departamentos</p>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #f3f4f6;">
                            <span style="color: #f59e0b; font-size: 12px; font-weight: 500;">Click para gestionar â†’</span>
                        </div>
                    </div>
                    
                    <!-- Proyectos -->
                    <div class="catalog-card" style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; background: #fff; cursor: pointer; transition: all 0.2s;" onclick="showView('proyectos')">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                <span style="color: white; font-size: 18px;">ğŸš€</span>
                            </div>
                            <h3 style="margin: 0; color: #1f2937; font-size: 16px;">Proyectos</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin: 0; line-height: 1.4;">Gestiona proyectos completos y sus relaciones</p>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #f3f4f6;">
                            <span style="color: #8b5cf6; font-size: 12px; font-weight: 500;">Ir a gestiÃ³n avanzada â†’</span>
                        </div>
                    </div>
                    
                    <!-- CÃ©lulas -->
                    <div class="catalog-card" style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; background: #fff; cursor: pointer; transition: all 0.2s;" onclick="openCatalogManager('Celulas')">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #ec4899, #db2777); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                <span style="color: white; font-size: 18px;">ğŸ”¬</span>
                            </div>
                            <h3 style="margin: 0; color: #1f2937; font-size: 16px;">CÃ©lulas de Trabajo</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin: 0; line-height: 1.4;">Gestiona las cÃ©lulas operativas y equipos especializados</p>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #f3f4f6;">
                            <span style="color: #ec4899; font-size: 12px; font-weight: 500;">Click para gestionar â†’</span>
                        </div>
                    </div>
                    
                    <!-- CategorÃ­as de Equipos -->
                    <div class="catalog-card" style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; background: #fff; cursor: pointer; transition: all 0.2s;" onclick="openCatalogManager('inventario de categoria de equipos')">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                <span style="color: white; font-size: 18px;">ğŸ“¦</span>
                            </div>
                            <h3 style="margin: 0; color: #1f2937; font-size: 16px;">CategorÃ­as de Equipos</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin: 0; line-height: 1.4;">Define las categorÃ­as para clasificaciÃ³n del inventario</p>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #f3f4f6;">
                            <span style="color: #ef4444; font-size: 12px; font-weight: 500;">Click para gestionar â†’</span>
                        </div>
                    </div>
                </div>
                
                <!-- InformaciÃ³n adicional -->
                <div style="margin-top: 32px; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                    <h4 style="margin: 0 0 8px 0; color: #1f2937; font-size: 14px;">ğŸ’¡ InformaciÃ³n</h4>
                    <p style="margin: 0; color: #6b7280; font-size: 13px; line-height: 1.4;">
                        Los catÃ¡logos son listas maestras que alimentan los formularios del sistema. 
                        Cualquier cambio aquÃ­ se reflejarÃ¡ inmediatamente en todos los mÃ³dulos que utilicen estas listas.
                    </p>
                </div>
            </section>

            <!-- Modal de GestiÃ³n de CatÃ¡logos - NUEVO -->
            <div id="catalog-manager-modal" class="modal" style="display: none; z-index: 9999;">
                <div class="modal-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
                    <!-- Header del modal -->
                    <div class="modal-header" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; padding: 20px; border-radius: 12px 12px 0 0; position: sticky; top: 0; z-index: 10;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 id="catalog-manager-title" style="margin: 0; font-size: 20px; font-weight: 600;">ğŸ“‹ GestiÃ³n de CatÃ¡logo</h3>
                                <p id="catalog-manager-subtitle" style="margin: 5px 0 0 0; opacity: 0.9; font-size: 14px;">Administra los elementos de esta lista</p>
                            </div>
                            <button onclick="closeCatalogManager()" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 36px; height: 36px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px;">
                                âœ•
                            </button>
                        </div>
                    </div>
                    
                    <!-- Formulario para agregar elementos -->
                    <div style="padding: 24px; border-bottom: 1px solid #e5e7eb;">
                        <h4 style="margin: 0 0 12px 0; color: #1f2937; font-size: 16px;">â• Agregar Nuevo Elemento</h4>
                        <form onsubmit="addCatalogElement(event)" style="display: flex; gap: 12px; align-items: flex-end;">
                            <div style="flex: 1;">
                                <label style="display: block; margin-bottom: 6px; color: #374151; font-weight: 500; font-size: 14px;">Nombre del elemento:</label>
                                <input 
                                    type="text" 
                                    id="catalog-input" 
                                    placeholder="Ingresa el nombre del nuevo elemento..." 
                                    required
                                    style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; transition: border-color 0.2s;"
                                    onfocus="this.style.borderColor='#3b82f6'"
                                    onblur="this.style.borderColor='#e5e7eb'"
                                >
                            </div>
                            <button type="submit" style="background: #3b82f6; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; transition: background 0.2s;" onmouseover="this.style.background='#2563eb'" onmouseout="this.style.background='#3b82f6'">
                                âœ… Agregar
                            </button>
                        </form>
                    </div>
                    
                    <!-- Lista de elementos -->
                    <div style="padding: 24px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                            <h4 style="margin: 0; color: #1f2937; font-size: 16px;">ğŸ“‹ Elementos Actuales</h4>
                            <button onclick="refreshCatalogList()" style="background: #6b7280; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; transition: background 0.2s;" onmouseover="this.style.background='#4b5563'" onmouseout="this.style.background='#6b7280'">
                                ğŸ”„ Actualizar
                            </button>
                        </div>
                        <div id="catalog-elements-list" style="min-height: 200px;">
                            <div style="text-align: center; padding: 40px; color: #9ca3af;">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ“‚</div>
                                <div>Cargando elementos...</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Footer con estadÃ­sticas -->
                    <div id="catalog-footer" style="background: #f8fafc; padding: 16px 24px; border-top: 1px solid #e5e7eb; border-radius: 0 0 12px 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 14px; color: #6b7280;">
                            <span id="catalog-count">Total: 0 elementos</span>
                            <span style="font-size: 12px;">ğŸ’¾ Los cambios se guardan automÃ¡ticamente</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal para candidatos -->
            <div id="candidate-modal" class="modal" style="display:none">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="candidate-modal-title">Agregar Candidato</h3>
                        <button type="button" class="modal-close" id="candidate-modal-close">&times;</button>
                    </div>
                    <form id="candidate-form">
                        <input type="hidden" id="candidate-id">
                        <div style="display:flex;gap:10px">
                            <input type="text" id="candidate-first" placeholder="Nombre" required>
                            <input type="text" id="candidate-last" placeholder="Apellido" required>
                        </div>
                        <input type="text" id="candidate-email" placeholder="Email (opcional)">
                        <input type="text" id="candidate-phone" placeholder="TelÃ©fono (opcional)">
                        <input type="text" id="candidate-position" placeholder="PosiciÃ³n solicitada" required>
                        <select id="candidate-status" style="width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                            <option value="En revisiÃ³n">En revisiÃ³n</option>
                            <option value="Entrevista">Entrevista</option>
                            <option value="Oferta">Oferta</option>
                            <option value="Rechazado">Rechazado</option>
                            <option value="Contratado">Contratado</option>
                        </select>
                        <textarea id="candidate-notes" placeholder="Notas (opcional)" style="width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff;font-family:Inter,Arial"></textarea>
                        <div style="margin-top:16px;display:flex;gap:8px">
                            <button type="submit" id="candidate-submit">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal para Vacaciones -->
            <div id="vacation-modal" class="modal" style="display:none">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="vacation-modal-title">Nueva Solicitud de Vacaciones</h3>
                        <button type="button" class="modal-close" id="vacation-modal-close">&times;</button>
                    </div>
                    <form id="vacation-form">
                        <input type="hidden" id="vacation-id">
                        <div style="display:flex;gap:10px;margin-bottom:10px">
                            <div style="flex:1">
                                <label class="field-label">Empleado</label>
                                <select id="vacation-employee" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff" required>
                                    <option value="">Seleccionar empleado...</option>
                                </select>
                            </div>
                        </div>
                        <div style="display:flex;gap:10px;margin-bottom:10px">
                            <div style="flex:1">
                                <label class="field-label">Fecha Inicio</label>
                                <input type="date" id="vacation-start-date" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff" required>
                            </div>
                            <div style="flex:1">
                                <label class="field-label">Fecha Fin</label>
                                <input type="date" id="vacation-end-date" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff" required>
                            </div>
                        </div>
                        <div style="display:flex;gap:10px;margin-bottom:10px">
                            <div style="flex:1">
                                <label class="field-label">Estado</label>
                                <select id="vacation-status" style="width:100%;padding:12px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff" required>
                                    <option value="Pendiente">Pendiente</option>
                                    <option value="Aprobado">Aprobado</option>
                                    <option value="Rechazado">Rechazado</option>
                                </select>
                            </div>
                        </div>
                        <div style="margin-top:16px;display:flex;gap:8px">
                            <button type="submit" id="vacation-submit">Guardar</button>
                            <button type="button" id="vacation-cancel">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal para el formulario de alta/ediciÃ³n -->
            <div id="employee-modal" class="modal" style="display:none">
                <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
                    <div class="modal-header">
                        <h3 id="modal-title">Agregar Empleado</h3>
                        <button type="button" class="modal-close" id="modal-close">&times;</button>
                    </div>
                    
                    <!-- PestaÃ±as -->
                    <div class="tab-container">
                        <div class="tab-buttons">
                            <button type="button" class="tab-button active" data-tab="general">InformaciÃ³n General</button>
                            <button type="button" class="tab-button" data-tab="expediente">Expediente</button>
                            <button type="button" class="tab-button" data-tab="hr">Recursos Humanos</button>
                            <button type="button" class="tab-button" data-tab="asignaciones">Asignaciones</button>
                        </div>

                        <form id="employee-form">
                            <input type="hidden" id="employee-id">
                            
                            <!-- PestaÃ±a: InformaciÃ³n General -->
                            <div class="tab-content active" id="tab-general">
                                
                                <!-- InformaciÃ³n Personal -->
                                <div class="form-section">
                                    <h4>InformaciÃ³n Personal</h4>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-first" class="field-label">Nombre</label>
                                            <input type="text" id="employee-first" placeholder="Nombre" required>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-last" class="field-label">Apellido</label>
                                            <input type="text" id="employee-last" placeholder="Apellido" required>
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-code" class="field-label">CÃ³digo empleado</label>
                                            <input type="text" id="employee-code" placeholder="CÃ³digo empleado (opcional)">
                                        </div>
                                        <div style="flex:1">
                                            <!-- Campo vacÃ­o para mantener el layout -->
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-position" class="field-label">Puesto / Rol</label>
                                            <select id="employee-position" required>
                                                <option value="">Seleccionar posiciÃ³n...</option>
                                            </select>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-entity" class="field-label">Entidad</label>
                                            <select id="employee-entity">
                                                <option value="">Seleccionar entidad...</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-area" class="field-label">Ãrea</label>
                                            <select id="employee-area">
                                                <option value="">Seleccionar Ã¡rea...</option>
                                            </select>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-project" class="field-label">Proyecto</label>
                                            <select id="employee-project">
                                                <option value="">Seleccionar proyecto...</option>
                                            </select>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-cell" class="field-label">CÃ©lula</label>
                                            <select id="employee-cell">
                                                <option value="">Seleccionar cÃ©lula...</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div style="margin-top:6px">
                                        <label for="employee-status" class="field-label">Estado</label>
                                        <select id="employee-status">
                                            <option value="Activo">Activo</option>
                                            <option value="Inactivo">Inactivo</option>
                                            <option value="En licencia">En licencia</option>
                                            <option value="Suspendido">Suspendido</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Contacto -->
                                <div class="form-section">
                                    <h4>Contacto</h4>
                                    <label for="employee-email" class="field-label">Email</label>
                                    <input type="email" id="employee-email" placeholder="Email (opcional)">
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-phone" class="field-label">TelÃ©fono corporativo</label>
                                            <input type="text" id="employee-phone" placeholder="TelÃ©fono corporativo (opcional)">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-personal-phone" class="field-label">TelÃ©fono personal</label>
                                            <input type="text" id="employee-personal-phone" placeholder="TelÃ©fono personal (opcional)">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- PestaÃ±a: Expediente -->
                            <div class="tab-content" id="tab-expediente">
                                
                                <!-- InformaciÃ³n Personal -->
                                <div class="form-section">
                                    <h4>InformaciÃ³n Personal</h4>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-birth" class="field-label">Fecha de nacimiento</label>
                                            <input type="date" id="employee-birth" placeholder="Fecha de nacimiento">
                                        </div>
                                        <div style="flex:1">
                                            <!-- Espacio para futuros campos -->
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- DirecciÃ³n -->
                                <div class="form-section">
                                    <h4>DirecciÃ³n</h4>
                                    <label for="employee-address-street" class="field-label">Calle</label>
                                    <input type="text" id="employee-address-street" placeholder="Nombre de la calle">
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-address-exterior" class="field-label">NÃºmero exterior</label>
                                            <input type="text" id="employee-address-exterior" placeholder="NÃºmero exterior">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-address-interior" class="field-label">NÃºmero interior</label>
                                            <input type="text" id="employee-address-interior" placeholder="NÃºmero interior (opcional)">
                                        </div>
                                    </div>
                                    <label for="employee-address-colonia" class="field-label">Colonia</label>
                                    <input type="text" id="employee-address-colonia" placeholder="Colonia o barrio">
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-address-city" class="field-label">Ciudad</label>
                                            <input type="text" id="employee-address-city" placeholder="Ciudad">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-address-state" class="field-label">Estado</label>
                                            <select id="employee-address-state">
                                                <option value="">Seleccionar estado...</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-address-postal-code" class="field-label">CÃ³digo Postal</label>
                                            <input type="text" id="employee-address-postal-code" placeholder="CÃ³digo postal">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-address-country" class="field-label">PaÃ­s</label>
                                            <select id="employee-address-country">
                                                <option value="">Seleccionar paÃ­s...</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Documentos -->
                                <div class="form-section">
                                    <h4>Documentos</h4>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-curp" class="field-label">CURP</label>
                                            <input type="text" id="employee-curp" placeholder="CURP" maxlength="18">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-rfc" class="field-label">RFC</label>
                                            <input type="text" id="employee-rfc" placeholder="RFC" maxlength="13">
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-nss" class="field-label">NSS (NÃºmero de Seguro Social)</label>
                                            <input type="text" id="employee-nss" placeholder="NÃºmero de Seguro Social">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-passport" class="field-label">Pasaporte</label>
                                            <input type="text" id="employee-passport" placeholder="NÃºmero de pasaporte (opcional)">
                                        </div>
                                    </div>
                                </div>

                                <!-- InformaciÃ³n Personal Adicional -->
                                <div class="form-section">
                                    <h4>InformaciÃ³n Personal</h4>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-gender" class="field-label">GÃ©nero</label>
                                            <select id="employee-gender">
                                                <option value="">Seleccionar...</option>
                                                <option value="Masculino">Masculino</option>
                                                <option value="Femenino">Femenino</option>
                                                <option value="Otro">Otro</option>
                                                <option value="Prefiero no decir">Prefiero no decir</option>
                                            </select>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-marital-status" class="field-label">Estado Civil</label>
                                            <select id="employee-marital-status">
                                                <option value="">Seleccionar...</option>
                                                <option value="Soltero(a)">Soltero(a)</option>
                                                <option value="Casado(a)">Casado(a)</option>
                                                <option value="Divorciado(a)">Divorciado(a)</option>
                                                <option value="Viudo(a)">Viudo(a)</option>
                                                <option value="UniÃ³n libre">UniÃ³n libre</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-nationality" class="field-label">Nacionalidad</label>
                                            <select id="employee-nationality">
                                                <option value="">Seleccionar...</option>
                                                <option value="Mexicana">Mexicana</option>
                                                <option value="EspaÃ±ola">EspaÃ±ola</option>
                                                <option value="Estadounidense">Estadounidense</option>
                                                <option value="Otra">Otra</option>
                                            </select>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-blood-type" class="field-label">Tipo de Sangre</label>
                                            <select id="employee-blood-type">
                                                <option value="">Seleccionar...</option>
                                                <option value="A+">A+</option>
                                                <option value="A-">A-</option>
                                                <option value="B+">B+</option>
                                                <option value="B-">B-</option>
                                                <option value="AB+">AB+</option>
                                                <option value="AB-">AB-</option>
                                                <option value="O+">O+</option>
                                                <option value="O-">O-</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- PestaÃ±a: Recursos Humanos -->
                            <div class="tab-content" id="tab-hr">
                                
                                <!-- InformaciÃ³n Bancaria -->
                                <div class="form-section">
                                    <h4>InformaciÃ³n Bancaria</h4>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-bank-name" class="field-label">Banco</label>
                                            <input type="text" id="employee-bank-name" placeholder="Nombre del banco">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-account-holder" class="field-label">Nombre del titular</label>
                                            <input type="text" id="employee-account-holder" placeholder="Nombre completo">
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-account-number" class="field-label">NÃºmero de cuenta</label>
                                            <input type="text" id="employee-account-number" placeholder="NÃºmero de cuenta">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-clabe" class="field-label">CLABE interbancaria</label>
                                            <input type="text" id="employee-clabe" placeholder="18 dÃ­gitos" maxlength="18">
                                        </div>
                                    </div>
                                    <div style="margin-top:10px">
                                        <label for="employee-clabe-document" class="field-label">Documento CLABE</label>
                                        <input type="file" id="employee-clabe-document" accept=".pdf,.jpg,.jpeg,.png">
                                    </div>
                                </div>

                                <!-- Esquema de ContrataciÃ³n -->
                                <div class="form-section">
                                    <h4>Esquema de ContrataciÃ³n</h4>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-contract-type" class="field-label">Tipo de contrato</label>
                                            <select id="employee-contract-type">
                                                <option value="">Seleccionar tipo...</option>
                                            </select>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-obra" class="field-label">Obra</label>
                                            <input type="text" id="employee-obra" placeholder="Nombre de la obra">
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-contract-scheme" class="field-label">Esquema de contrataciÃ³n</label>
                                            <select id="employee-contract-scheme">
                                                <option value="">Seleccionar esquema...</option>
                                            </select>
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-initial-rate" class="field-label">Tarifa inicial</label>
                                            <input type="number" step="0.01" id="employee-initial-rate" placeholder="0.00">
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-gross-salary" class="field-label">Salario bruto mensual</label>
                                            <input type="number" step="0.01" id="employee-gross-salary" placeholder="0.00">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-net-salary" class="field-label">Salario neto mensual</label>
                                            <input type="number" step="0.01" id="employee-net-salary" placeholder="0.00">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-company-cost" class="field-label">Costo empresa</label>
                                            <input type="number" step="0.01" id="employee-company-cost" placeholder="0.00">
                                        </div>
                                    </div>
                                    <div style="display:flex;gap:10px">
                                        <div style="flex:1">
                                            <label for="employee-hire-date" class="field-label">Fecha de ingreso</label>
                                            <input type="date" id="employee-hire-date">
                                        </div>
                                        <div style="flex:1">
                                            <label for="employee-end-date" class="field-label">Fecha de baja</label>
                                            <input type="date" id="employee-end-date">
                                        </div>
                                    </div>
                                    <div style="margin-top:10px">
                                        <label for="employee-termination-reason" class="field-label">Motivo de baja</label>
                                        <textarea id="employee-termination-reason" placeholder="Motivo de baja (opcional)" rows="3" style="width:100%;"></textarea>
                                    </div>
                                    <div style="margin-top:10px">
                                        <label>
                                            <input type="checkbox" id="employee-rehireable" checked> Recontratable
                                        </label>
                                    </div>
                                    <div style="margin-top:10px">
                                        <label for="employee-contract-document" class="field-label">Documento del contrato</label>
                                        <input type="file" id="employee-contract-document" accept=".pdf,.doc,.docx">
                                    </div>
                                </div>

                                <!-- Historial de Contratos -->
                                <div class="form-section">
                                    <h4>Historial de Contratos</h4>
                                    <div id="contracts-list" class="contracts-list">
                                        <p><em>Selecciona un empleado para ver su historial de contratos</em></p>
                                    </div>
                                </div>
                            </div>

                            <!-- PestaÃ±a: Asignaciones -->
                            <div class="tab-content" id="tab-asignaciones">
                                <div class="form-section">
                                    <h4>Historial de Proyectos</h4>
                                    <div id="employee-assignments-loading" style="text-align:center;padding:20px;color:#666;display:none">
                                        Cargando historial de proyectos...
                                    </div>
                                    <div id="employee-assignments-empty" style="text-align:center;padding:20px;color:#999;display:none">
                                        <div style="font-size:32px;margin-bottom:10px">ğŸ“‹</div>
                                        <div>Este empleado no tiene asignaciones registradas</div>
                                    </div>
                                    <div id="employee-assignments-container" style="display:none">
                                        <div id="employee-assignments-summary" style="background:#f8f9fa;border:1px solid #e5e7eb;border-radius:8px;padding:16px;margin-bottom:20px;display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px">
                                            <div>
                                                <div style="font-size:24px;font-weight:bold;color:#007bff" id="emp-total-projects">0</div>
                                                <div style="font-size:12px;color:#6b7280">Total Proyectos</div>
                                            </div>
                                            <div>
                                                <div style="font-size:24px;font-weight:bold;color:#28a745" id="emp-active-projects">0</div>
                                                <div style="font-size:12px;color:#6b7280">Proyectos Activos</div>
                                            </div>
                                            <div>
                                                <div style="font-size:24px;font-weight:bold;color:#6c757d" id="emp-completed-projects">0</div>
                                                <div style="font-size:12px;color:#6b7280">Completados</div>
                                            </div>
                                            <div>
                                                <div style="font-size:24px;font-weight:bold;color:#17a2b8" id="emp-total-hours">0</div>
                                                <div style="font-size:12px;color:#6b7280">Horas Totales</div>
                                            </div>
                                        </div>
                                        <table class="employee-table" id="employee-assignments-table" style="width:100%">
                                            <thead>
                                                <tr>
                                                    <th>ğŸ“‹ Proyecto</th>
                                                    <th>ğŸ¯ Rol</th>
                                                    <th>ğŸ“… Inicio</th>
                                                    <th>ğŸ“… Fin</th>
                                                    <th>â° Horas</th>
                                                    <th>ğŸ“Š Estado</th>
                                                </tr>
                                            </thead>
                                            <tbody id="employee-assignments-tbody">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div style="margin-top:16px;display:flex;gap:8px">
                                <button type="submit" id="employee-submit">Guardar</button>
                                <button type="button" id="employee-cancel">Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de EdiciÃ³n de Equipos -->
    <div id="equipment-modal" class="modal" style="display:none">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="equipment-modal-title">Agregar Equipo</h3>
                <button type="button" class="modal-close" id="equipment-modal-close" onclick="closeEquipmentModal()">&times;</button>
            </div>
            <form id="equipment-form">
                <input type="text" id="equip-codigo" placeholder="CÃ³digo" required readonly style="background:#f3f4f6">
                <input type="text" id="equip-nombre" placeholder="Nombre del equipo" required>
                <div style="display:flex;gap:10px">
                    <select id="equip-marca" style="flex:1;width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                        <option value="">Marca...</option>
                        <option value="Dell">Dell</option>
                        <option value="HP">HP</option>
                        <option value="Samsung">Samsung</option>
                        <option value="Lenovo">Lenovo</option>
                        <option value="Apple">Apple</option>
                        <option value="Officeline">Officeline</option>
                        <option value="Microsoft">Microsoft</option>
                    </select>
                    <input type="text" id="equip-modelo" placeholder="Modelo" style="flex:1">
                </div>
                <input type="text" id="equip-serie" placeholder="NÃºmero de serie">
                <select id="equip-categoria" required style="width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                    <option value="">CategorÃ­a...</option>
                    <option value="Computo">Computo</option>
                    <option value="Mobiliario">Mobiliario</option>
                    <option value="Electronico">Electronico</option>
                    <option value="Herramientas">Herramientas</option>
                    <option value="Vehiculos">Vehiculos</option>
                </select>
                <select id="equip-ubicacion" style="width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                    <option value="">UbicaciÃ³n...</option>
                    <option value="Oficina 201">Oficina 201</option>
                    <option value="Oficina 202">Oficina 202</option>
                    <option value="Ãrea ComÃºn">Ãrea ComÃºn</option>
                    <option value="AlmacÃ©n">AlmacÃ©n</option>
                    <option value="RecepciÃ³n">RecepciÃ³n</option>
                </select>
                <select id="equip-asignado" style="width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                    <option value="">Asignado a...</option>
                </select>
                <select id="equip-estado" required style="width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff">
                    <option value="Activo">Activo</option>
                    <option value="Inactivo">Inactivo</option>
                    <option value="Mantenimiento">Mantenimiento</option>
                    <option value="Baja">Baja</option>
                </select>
                <div style="display:flex;gap:10px">
                    <input type="number" id="equip-valor" placeholder="Valor ($)" step="0.01" min="0" style="flex:1">
                    <input type="date" id="equip-fecha" placeholder="Fecha de compra" style="flex:1">
                </div>
                <textarea id="equip-observaciones" placeholder="Observaciones (opcional)" style="width:100%;padding:12px;margin-bottom:10px;border:1px solid #e6eef8;border-radius:8px;background:#fbfdff;font-family:Inter,Arial" rows="3"></textarea>
                <div style="margin-top:16px;display:flex;gap:8px">
                    <button type="submit" id="equipment-submit">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal universal para gestionar listas de mastercode -->
    <!-- Modal para gestionar categorÃ­as -->
    <div id="categories-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="categories-modal-title">ğŸ“‚ GestiÃ³n de CategorÃ­as de Equipos</h3>
                <button type="button" class="close-btn" onclick="closeCategoriesModal()">âœ•</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div style="margin-bottom: 20px;">
                    <p style="color: #6b7280; margin: 0;">
                        Administra las categorÃ­as disponibles para equipos desde el catÃ¡logo maestro "inventario de categoria de equipos"
                    </p>
                </div>

                <!-- Lista actual de categorÃ­as -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #374151; margin-bottom: 15px;">ğŸ“‹ CategorÃ­as Actuales</h4>
                    <div id="categories-list" style="border: 1px solid #e5e7eb; border-radius: 6px; max-height: 200px; overflow-y: auto;">
                        <!-- Se llenarÃ¡ dinÃ¡micamente -->
                        <div style="padding: 20px; text-align: center; color: #9ca3af;">
                            <div style="font-size: 14px;">Cargando categorÃ­as...</div>
                        </div>
                    </div>
                </div>

                <!-- Formulario para agregar nueva categorÃ­a -->
                <div style="border-top: 1px solid #e5e7eb; padding-top: 20px;">
                    <h4 style="color: #374151; margin-bottom: 15px;">â• Agregar Nueva CategorÃ­a</h4>
                    <form id="add-category-form" style="display: flex; gap: 10px; align-items: end;">
                        <div style="flex: 1;">
                            <label for="new-category-name" style="display: block; font-weight: 500; margin-bottom: 5px; color: #374151;">
                                Nombre de la categorÃ­a
                            </label>
                            <input type="text" id="new-category-name" name="name" placeholder="Ej: Computo, Mobiliario..." 
                                   style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;" required>
                        </div>
                        <button type="submit" style="background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
                            âœ… Agregar
                        </button>
                    </form>
                </div>

                <!-- Botones de acciÃ³n -->
                <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <button type="button" onclick="refreshCategoriesList()" 
                                style="background: #6b7280; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
                            ğŸ”„ Actualizar Lista
                        </button>
                        <button type="button" onclick="closeCategoriesModal()" 
                                style="background: #374151; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
                            âœ… Cerrar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/employees.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/candidates.js"></script>
    <script src="js/import.js"></script>
    <script src="js/catalogs.js"></script>
    <script src="js/geographic.js"></script>
    <script src="js/status.js"></script>
    <script src="js/inventory.js"></script>
    <script src="js/assignments.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        // Initialize authentication UI after all scripts loaded
        document.addEventListener('DOMContentLoaded', () => {
            initAuthUI();
        });
    </script>
    
    <!-- Sistema de pestaÃ±as serÃ¡ manejado completamente por app.js -->
</body>
</html>